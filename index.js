"use strict";exports.__esModule=true;exports.readTemplate=exports.run=void 0;var tezcatl_constants_1=require("@makechtec/tezcatl-constants");var tezcatl_cli_1=require("@makechtec/tezcatl-cli");var pipe_1=require("@makechtec/pipe");var tezcatl_conditional_processor_1=require("@makechtec/tezcatl-conditional-processor");var tezcatl_iterative_processor_1=require("@makechtec/tezcatl-iterative-processor");var tezcatl_settings_1=require("@makechtec/tezcatl-settings");var run=function(){var line=tezcatl_cli_1.CLI.getArgumentValue(ARGS.line);var block=tezcatl_cli_1.CLI.getArgumentValue(ARGS.block);var moreArgs=tezcatl_cli_1.CLI.getAllArguments();var config=tezcatl_settings_1.Settings.get();var fileName=tezcatl_cli_1.CLI.getArgumentValue(ARGS.file).value;if(fileName===""){fileName=config.file}var content=(0,exports.readTemplate)(block.value);var pipe=new pipe_1.Pipe(content);var conditionalProcessor=new tezcatl_conditional_processor_1.ConditionalProcessor;var iterativeProcessor=new tezcatl_iterative_processor_1.IterativeProcessor;var finalContent=pipe.addAction((function(newContent){return conditionalProcessor.parse(newContent)})).addAction((function(newContent){return iterativeProcessor.parse(newContent)})).addAction((function(newContent){return tezcatl_cli_1.Reader.changePlaceholders(newContent,moreArgs)})).execActions();console.log(finalContent);tezcatl_cli_1.Writter.insertInLine(fileName,line.value,finalContent)};exports.run=run;var readTemplate=function(templateName){var content=tezcatl_cli_1.Reader.read(USER_TEMPLATE_DIR+templateName+tezcatl_constants_1.TEMPLATE_EXTENSION);if(content===""){content=tezcatl_cli_1.Reader.read(DEFAULT_TEMPLATE_DIR+templateName+tezcatl_constants_1.TEMPLATE_EXTENSION)}return content};exports.readTemplate=readTemplate;var ARGS={file:"f",line:"l",block:"b"};var USER_TEMPLATE_DIR="./templates/";var DEFAULT_TEMPLATE_DIR="./node_modules/@makechtec/tezcatl-preset-puzzle/templates/";