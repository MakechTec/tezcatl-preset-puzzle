"use strict";exports.__esModule=true;exports.DEFAULT_TEMPLATE_DIR=exports.USER_TEMPLATE_DIR=exports.ARGS=exports.readTemplate=exports.run=void 0;var tezcatl_constants_1=require("@makechtec/tezcatl-constants");var tezcatl_cli_1=require("@makechtec/tezcatl-cli");var pipe_1=require("@makechtec/pipe");var tezcatl_conditional_processor_1=require("@makechtec/tezcatl-conditional-processor");var tezcatl_iterative_processor_1=require("@makechtec/tezcatl-iterative-processor");var tezcatl_settings_1=require("@makechtec/tezcatl-settings");var tezcatl_placeholder_processor_1=require("@makechtec/tezcatl-placeholder-processor");var run=function(){var conditionalProcessor=new tezcatl_conditional_processor_1.ConditionalProcessor;var iterativeProcessor=new tezcatl_iterative_processor_1.IterativeProcessor;var placeholderProcessor=new tezcatl_placeholder_processor_1.PlaceholderProcessor;var line=tezcatl_cli_1.CLI.getArgumentValue(exports.ARGS.line).value;var block=tezcatl_cli_1.CLI.getArgumentValue(exports.ARGS.block).value;var fileName=tezcatl_cli_1.CLI.getArgumentValue(exports.ARGS.file).value;var config=tezcatl_settings_1.Settings.get();if(fileName===""){fileName=config.file}var content=(0,exports.readTemplate)(block);var finalContent=new pipe_1.Pipe(content).addAction((function(newContent){return conditionalProcessor.parse(newContent)})).addAction((function(newContent){return iterativeProcessor.parse(newContent)})).addAction((function(newContent){return placeholderProcessor.parse(newContent)})).execActions();tezcatl_cli_1.Writter.insertInLine(fileName,line,finalContent)};exports.run=run;var readTemplate=function(templateName){var templateDir=tezcatl_cli_1.CLI.getArgumentValue(exports.ARGS.templateDir);var content="";if(templateDir.value===""){templateDir=tezcatl_settings_1.Settings.get().templateDir;content=tezcatl_cli_1.Reader.read(templateDir+"/"+templateName+tezcatl_constants_1.TEMPLATE_EXTENSION)}if(content===""){content=tezcatl_cli_1.Reader.read(exports.USER_TEMPLATE_DIR+templateName+tezcatl_constants_1.TEMPLATE_EXTENSION)}if(content===""){content=tezcatl_cli_1.Reader.read(exports.DEFAULT_TEMPLATE_DIR+templateName+tezcatl_constants_1.TEMPLATE_EXTENSION)}return content};exports.readTemplate=readTemplate;exports.ARGS={file:"f",line:"l",block:"b",templateDir:"templateDir"};exports.USER_TEMPLATE_DIR="./templates/";exports.DEFAULT_TEMPLATE_DIR="./node_modules/@makechtec/tezcatl-preset-puzzle/templates/";